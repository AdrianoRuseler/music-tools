% Read all songs

% https://claude.ai/chat/adc9a1ab-6f16-497c-93a4-ab9c4cc91599

% Specify the full path and filename for your .db file
dbfile = 'C:\Users\ruseler\AppData\Local\Mixed In Key\Mixed In Key\11.0\MIKStore.db'; 

% Get specific columns only
basicInfo = readSongTable(dbfile, ...
    'Columns', {'Tempo', 'OverallEnergy', 'MainKey', 'MainKeyConfidence', 'OverallVolumeRMS1', 'OverallVolumeRMS2', 'OverallVolumeLUFS','Rating'});
disp(basicInfo(1, :));

% (keyStr, tempoVal, energyVal, MainKeyConfidence, OverallVolume, numStars)
for i = 1:2 % height(basicInfo)
    keyStr  = basicInfo.MainKey(i);
    tempoVal = basicInfo.Tempo(i);
    OverallVolume.RMS1 = basicInfo.OverallVolumeRMS1(i);
    OverallVolume.RMS2 = basicInfo.OverallVolumeRMS2(i);
    OverallVolume.LUFS = basicInfo.OverallVolumeLUFS(i);
    numStars = 2*basicInfo.Rating(i);
    ArtWorkFile{i} = TrackInfoImage(keyStr, tempoVal , 5, 0.4721, OverallVolume, numStars);
end
% OverallVolume.RMS1 = -12.5
% OverallVolume.RMS2 = -11.23
% OverallVolume.LUFS = -9
ArtWorkFile=TrackInfoImage('1A', 132.87, 5,0.4721,OverallVolume,7);




songs2 = readSongTable(dbfile);

songs = readSongTable(dbfile);
% songs = readSongDatabase(dbfile);
% Error using readSongDatabase (line 99)
% Error reading database: Input #2 expected to be a cell array, was int64 instead.
% Check the data
disp(songs2(1, {'ArtistName', 'SongName', 'Tempo', 'Year'}));

disp(songs2(1, :));
% Filter by tempo and year
fastSongs = readSongTable(dbfile, ...
    'WhereClause', 'Tempo > 120 AND Year >= 2020');








% LastAnalyzedUtc NaT
TimeInfo = readSongTable(dbfile,'Columns', {'LastAnalyzedUtc', 'LastModifiedUtc', 'DateAdded'});

% Get top 50 songs ordered by date
recent = readSongTable(dbfile, ...
    'OrderBy', 'DateAdded DESC', ...
    'Limit', 50);

% Complex query
myFavorites = readSongTable(dbfile, ...
    'WhereClause', 'Rating >= 4 AND Genre = "Rock"', ...
    'OrderBy', 'ArtistName, Album, SongName', ...
    'Limit', 100);


% conn = sqlite(dbfile, 'readonly');
% result = fetch(conn, 'SELECT IFNULL(ArtistName, '''') AS ArtistName, IFNULL(SongName, '''') AS SongName FROM Song LIMIT 5');
% close(conn);
% class(result)
% size(result)


conn = sqlite(dbfile, 'readonly');
result = fetch(conn, 'SELECT DateAdded FROM Song WHERE DateAdded IS NOT NULL LIMIT 5');
result
close(conn);


dates = readSongTable(dbfile, 'Columns', {'LastAnalyzedUtc', 'LastModifiedUtc', 'DateAdded'});
dates(1:5,:)

dates = readSongTable(dbfile, 'Columns', {'DateAdded'});